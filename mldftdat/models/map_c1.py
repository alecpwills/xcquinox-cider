# Autocode from mathematica for VSXC-type contribs
import numpy as np

alpha_x = 0.001867
alpha_ss, alpha_os = 0.00515088, 0.00304966
CF = 0.3 * (6 * np.pi**2)**(2.0/3)

class VSXCContribs():

    def __init__(self, cx, css, cos, dx, dss, dos):
        self.cx = cx
        self.css = css
        self.cos = cos
        self.dx = dx
        self.dss = dss
        self.dos = dos

    def get_xeff_and_deriv(self, f, use_cos = False):
        if use_cos:
            d1, d2, d3, d4 = self.cos
        else:
            d1, d2, d3, d4 = self.cx
        res = (d4*(1 - f**6)**4)/(1 + f**6)**4 + (d3*(1 - f**6)**3)/(1 + f**6)**3 + (d2*(1 - f**6)**2)/(1 + f**6)**2 + (d1*(1 - f**6))/(1 + f**6)
        dres = (-24*d4*f**5*(1 - f**6)**4)/(1 + f**6)**5 - (18*d3*f**5*(1 - f**6)**3)/(1 + f**6)**4 - (24*d4*f**5*(1 - f**6)**3)/(1 + f**6)**4 - (12*d2*f**5*(1 - f**6)**2)/(1 + f**6)**3 - (18*d3*f**5*(1 - f**6)**2)/(1 + f**6)**3 - (6*d1*f**5*(1 - f**6))/(1 + f**6)**2 - (12*d2*f**5*(1 - f**6))/(1 + f**6)**2 - (6*d1*f**5)/(1 + f**6)
        return res, dres

    def get_xeff_and_deriv_ss(self, f, n, g2, t):
        d1, d2, d3, d4 = self.css

        res = (((d4*(1 - f**6)**4)/(1 + f**6)**4 + (d3*(1 - f**6)**3)/(1 + f**6)**3 + (d2*(1 - f**6)**2)/(1 + f**6)**2 + (d1*(1 - f**6))/(1 + f**6))*(-g2/8. + n*t))/(n*t)
        df = (((-24*d4*f**5*(1 - f**6)**4)/(1 + f**6)**5 - (18*d3*f**5*(1 - f**6)**3)/(1 + f**6)**4 - (24*d4*f**5*(1 - f**6)**3)/(1 + f**6)**4 - (12*d2*f**5*(1 - f**6)**2)/(1 + f**6)**3 - (18*d3*f**5*(1 - f**6)**2)/(1 + f**6)**3 - (6*d1*f**5*(1 - f**6))/(1 + f**6)**2 - (12*d2*f**5*(1 - f**6))/(1 + f**6)**2 - (6*d1*f**5)/(1 + f**6))*(-g2/8. + n*t))/(n*t)
        dn = ((d4*(1 - f**6)**4)/(1 + f**6)**4 + (d3*(1 - f**6)**3)/(1 + f**6)**3 + (d2*(1 - f**6)**2)/(1 + f**6)**2 + (d1*(1 - f**6))/(1 + f**6))/n - (((d4*(1 - f**6)**4)/(1 + f**6)**4 + (d3*(1 - f**6)**3)/(1 + f**6)**3 + (d2*(1 - f**6)**2)/(1 + f**6)**2 + (d1*(1 - f**6))/(1 + f**6))*(-g2/8. + n*t))/(n**2*t)
        dg2= -((d4*(1 - f**6)**4)/(1 + f**6)**4 + (d3*(1 - f**6)**3)/(1 + f**6)**3 + (d2*(1 - f**6)**2)/(1 + f**6)**2 + (d1*(1 - f**6))/(1 + f**6))/(8.*n*t)
        dt = ((d4*(1 - f**6)**4)/(1 + f**6)**4 + (d3*(1 - f**6)**3)/(1 + f**6)**3 + (d2*(1 - f**6)**2)/(1 + f**6)**2 + (d1*(1 - f**6))/(1 + f**6))/t - (((d4*(1 - f**6)**4)/(1 + f**6)**4 + (d3*(1 - f**6)**3)/(1 + f**6)**3 + (d2*(1 - f**6)**2)/(1 + f**6)**2 + (d1*(1 - f**6))/(1 + f**6))*(-g2/8. + n*t))/(n*t**2)

        return res, df, dn, dg2, dt

    def get_f_and_deriv_ex(self, n, g2, t):

        d0x, d1x, d2x, d3x, d4x, d5x = self.dx

        f = ((d3x*g2**2)/n**5.333333333333333 + (2*d4x*g2*(-CF + t/n))/n**2.6666666666666665 + 4*d5x*(-CF + t/n)**2)/(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**3 + ((d1x*g2)/n**2.6666666666666665 + 2*d2x*(-CF + t/n))/(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**2 + d0x*(-1 + 1/(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n))))

        dn = (-3*alphax*((-8*g2)/(3.*n**3.6666666666666665) - (2*t)/n**2)*((d3x*g2**2)/n**5.333333333333333 + (2*d4x*g2*(-CF + t/n))/n**2.6666666666666665 + 4*d5x*(-CF + t/n)**2))/(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**4 - (2*alphax*((-8*g2)/(3.*n**3.6666666666666665) - (2*t)/n**2)*((d1x*g2)/n**2.6666666666666665 + 2*d2x*(-CF + t/n)))/(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**3 + ((-16*d3x*g2**2)/(3.*n**6.333333333333333) - (2*d4x*g2*t)/n**4.666666666666667 - (16*d4x*g2*(-CF + t/n))/(3.*n**3.6666666666666665) - (8*d5x*t*(-CF + t/n))/n**2)/(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**3 - (alphax*d0x*((-8*g2)/(3.*n**3.6666666666666665) - (2*t)/n**2))/(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**2 + ((-8*d1x*g2)/(3.*n**3.6666666666666665) - (2*d2x*t)/n**2)/(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**2
        dg2 = (-3*alphax*((d3x*g2**2)/n**5.333333333333333 + (2*d4x*g2*(-CF + t/n))/n**2.6666666666666665 + 4*d5x*(-CF + t/n)**2))/(n**2.6666666666666665*(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**4) - (2*alphax*((d1x*g2)/n**2.6666666666666665 + 2*d2x*(-CF + t/n)))/(n**2.6666666666666665*(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**3) + ((2*d3x*g2)/n**5.333333333333333 + (2*d4x*(-CF + t/n))/n**2.6666666666666665)/(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**3 - (alphax*d0x)/(n**2.6666666666666665*(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**2) + d1x/(n**2.6666666666666665*(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**2)
        dt = (-6*alphax*((d3x*g2**2)/n**5.333333333333333 + (2*d4x*g2*(-CF + t/n))/n**2.6666666666666665 + 4*d5x*(-CF + t/n)**2))/(n*(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**4) - (4*alphax*((d1x*g2)/n**2.6666666666666665 + 2*d2x*(-CF + t/n)))/(n*(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**3) + ((2*d4x*g2)/n**3.6666666666666665 + (8*d5x*(-CF + t/n))/n)/(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**3 - (2*alphax*d0x)/(n*(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**2) + (2*d2x)/(n*(1 + alphax*(g2/n**2.6666666666666665 + 2*(-CF + t/n)))**2)

        return f, dn, dg2, dt

    def get_en_and_deriv_corr(cu, cd, co, nu, nd, g2u, g2d, tu, td):

        d0ss, d1ss, d2ss, d3ss, d4ss, d5ss = self.dss 
        d0os, d1os, d2os, d3os, d4os, d5os = self.dos

        en = (cd*(-g2d/8. + nd*td)*(((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/(nd*td) + (cu*(-g2u/8. + nu*tu)*(((d3ss*g2u**2)/nu**5.333333333333333 + (2*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2u)/nu**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/(nu*tu) + co*((d3os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)**2 + 4*d4os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)*(-CF + tu/nu**1.6666666666666667) + 16*d5os*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3 + (d1os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665) + 4*d2os*(-CF + tu/nu**1.6666666666666667))/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2 + d0os*(-1 + 1/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))))

        dcu = ((-g2u/8. + nu*tu)*(((d3ss*g2u**2)/nu**5.333333333333333 + (2*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2u)/nu**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/(nu*tu)
        dcd = ((-g2d/8. + nd*td)*(((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/(nd*td)
        dco = (d3os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)**2 + 4*d4os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)*(-CF + tu/nu**1.6666666666666667) + 16*d5os*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3 + (d1os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665) + 4*d2os*(-CF + tu/nu**1.6666666666666667))/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2 + d0os*(-1 + 1/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667))))
        dnu = (cd*(-g2d/8. + nd*td)*((10*alphass*tu*((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2))/(nu**2.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**4) + (20*alphass*tu*((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667)))/(3.*nu**2.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3) + ((-10*d4ss*g2d*tu)/(3.*nd**2.6666666666666665*nu**2.6666666666666665) - (40*d5ss*tu*(-CF + tu/nu**1.6666666666666667))/(3.*nu**2.6666666666666665))/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + (10*alphass*d0ss*tu)/(3.*nu**2.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2) - (10*d2ss*tu)/(3.*nu**2.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2)))/(nd*td) + (cu*(-g2u/8. + nu*tu)*((-3*alphass*((-8*g2u)/(3.*nu**3.6666666666666665) - (10*tu)/(3.*nu**2.6666666666666665))*((d3ss*g2u**2)/nu**5.333333333333333 + (2*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**4 - (2*alphass*((-8*g2u)/(3.*nu**3.6666666666666665) - (10*tu)/(3.*nu**2.6666666666666665))*((d1ss*g2u)/nu**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667)))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((-16*d3ss*g2u**2)/(3.*nu**6.333333333333333) - (10*d4ss*g2u*tu)/(3.*nu**5.333333333333333) - (16*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/(3.*nu**3.6666666666666665) - (40*d5ss*tu*(-CF + tu/nu**1.6666666666666667))/(3.*nu**2.6666666666666665))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 - (alphass*d0ss*((-8*g2u)/(3.*nu**3.6666666666666665) - (10*tu)/(3.*nu**2.6666666666666665)))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + ((-8*d1ss*g2u)/(3.*nu**3.6666666666666665) - (10*d2ss*tu)/(3.*nu**2.6666666666666665))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2))/(nu*tu) + co*((-3*alphaos*((-8*g2u)/(3.*nu**3.6666666666666665) - (20*tu)/(3.*nu**2.6666666666666665))*(d3os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)**2 + 4*d4os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)*(-CF + tu/nu**1.6666666666666667) + 16*d5os*(-CF + tu/nu**1.6666666666666667)**2))/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**4 - (2*alphaos*((-8*g2u)/(3.*nu**3.6666666666666665) - (20*tu)/(3.*nu**2.6666666666666665))*(d1os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665) + 4*d2os*(-CF + tu/nu**1.6666666666666667)))/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3 + ((-16*d3os*g2u*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665))/(3.*nu**3.6666666666666665) - (20*d4os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)*tu)/(3.*nu**2.6666666666666665) - (32*d4os*g2u*(-CF + tu/nu**1.6666666666666667))/(3.*nu**3.6666666666666665) - (160*d5os*tu*(-CF + tu/nu**1.6666666666666667))/(3.*nu**2.6666666666666665))/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3 - (alphaos*d0os*((-8*g2u)/(3.*nu**3.6666666666666665) - (20*tu)/(3.*nu**2.6666666666666665)))/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2 + ((-8*d1os*g2u)/(3.*nu**3.6666666666666665) - (20*d2os*tu)/(3.*nu**2.6666666666666665))/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2) + (cu*(((d3ss*g2u**2)/nu**5.333333333333333 + (2*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2u)/nu**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/nu - (cu*(-g2u/8. + nu*tu)*(((d3ss*g2u**2)/nu**5.333333333333333 + (2*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2u)/nu**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/(nu**2*tu)
        dnd = (cd*(-g2d/8. + nd*td)*((8*alphass*g2d*((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2))/(nd**3.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**4) + (16*alphass*g2d*((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667)))/(3.*nd**3.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3) + ((-16*d3ss*g2d**2)/(3.*nd**6.333333333333333) - (16*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/(3.*nd**3.6666666666666665))/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + (8*alphass*d0ss*g2d)/(3.*nd**3.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2) - (8*d1ss*g2d)/(3.*nd**3.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2)))/(nd*td) + co*((8*alphaos*g2d*(d3os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)**2 + 4*d4os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)*(-CF + tu/nu**1.6666666666666667) + 16*d5os*(-CF + tu/nu**1.6666666666666667)**2))/(nd**3.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**4) + (16*alphaos*g2d*(d1os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665) + 4*d2os*(-CF + tu/nu**1.6666666666666667)))/(3.*nd**3.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3) + ((-16*d3os*g2d*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665))/(3.*nd**3.6666666666666665) - (32*d4os*g2d*(-CF + tu/nu**1.6666666666666667))/(3.*nd**3.6666666666666665))/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3 + (8*alphaos*d0os*g2d)/(3.*nd**3.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2) - (8*d1os*g2d)/(3.*nd**3.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2)) + (cd*(((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/nd - (cd*(-g2d/8. + nd*td)*(((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/(nd**2*td)
        dg2u = (cu*(-g2u/8. + nu*tu)*((-3*alphass*((d3ss*g2u**2)/nu**5.333333333333333 + (2*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2))/(nu**2.6666666666666665*(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**4) - (2*alphass*((d1ss*g2u)/nu**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667)))/(nu**2.6666666666666665*(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3) + ((2*d3ss*g2u)/nu**5.333333333333333 + (2*d4ss*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665)/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 - (alphass*d0ss)/(nu**2.6666666666666665*(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2) + d1ss/(nu**2.6666666666666665*(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2)))/(nu*tu) + co*((-3*alphaos*(d3os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)**2 + 4*d4os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)*(-CF + tu/nu**1.6666666666666667) + 16*d5os*(-CF + tu/nu**1.6666666666666667)**2))/(nu**2.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**4) - (2*alphaos*(d1os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665) + 4*d2os*(-CF + tu/nu**1.6666666666666667)))/(nu**2.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3) + ((2*d3os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665))/nu**2.6666666666666665 + (4*d4os*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665)/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3 - (alphaos*d0os)/(nu**2.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2) + d1os/(nu**2.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2)) - (cu*(((d3ss*g2u**2)/nu**5.333333333333333 + (2*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2u)/nu**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/(8.*nu*tu)
        dg2d = (cd*(-g2d/8. + nd*td)*((-3*alphass*((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2))/(nd**2.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**4) - (2*alphass*((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667)))/(nd**2.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3) + ((2*d3ss*g2d)/nd**5.333333333333333 + (2*d4ss*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665)/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 - (alphass*d0ss)/(nd**2.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2) + d1ss/(nd**2.6666666666666665*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2)))/(nd*td) + co*((-3*alphaos*(d3os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)**2 + 4*d4os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)*(-CF + tu/nu**1.6666666666666667) + 16*d5os*(-CF + tu/nu**1.6666666666666667)**2))/(nd**2.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**4) - (2*alphaos*(d1os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665) + 4*d2os*(-CF + tu/nu**1.6666666666666667)))/(nd**2.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3) + ((2*d3os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665))/nd**2.6666666666666665 + (4*d4os*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665)/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3 - (alphaos*d0os)/(nd**2.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2) + d1os/(nd**2.6666666666666665*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2)) - (cd*(((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/(8.*nd*td)
        dtu = (cd*(-g2d/8. + nd*td)*((-6*alphass*((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2))/(nu**1.6666666666666667*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**4) - (4*alphass*((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667)))/(nu**1.6666666666666667*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3) + ((2*d4ss*g2d)/(nd**2.6666666666666665*nu**1.6666666666666667) + (8*d5ss*(-CF + tu/nu**1.6666666666666667))/nu**1.6666666666666667)/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 - (2*alphass*d0ss)/(nu**1.6666666666666667*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2) + (2*d2ss)/(nu**1.6666666666666667*(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2)))/(nd*td) + (cu*(-g2u/8. + nu*tu)*((-6*alphass*((d3ss*g2u**2)/nu**5.333333333333333 + (2*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2))/(nu**1.6666666666666667*(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**4) - (4*alphass*((d1ss*g2u)/nu**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667)))/(nu**1.6666666666666667*(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3) + ((2*d4ss*g2u)/nu**4.333333333333333 + (8*d5ss*(-CF + tu/nu**1.6666666666666667))/nu**1.6666666666666667)/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 - (2*alphass*d0ss)/(nu**1.6666666666666667*(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2) + (2*d2ss)/(nu**1.6666666666666667*(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2)))/(nu*tu) + co*((-12*alphaos*(d3os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)**2 + 4*d4os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665)*(-CF + tu/nu**1.6666666666666667) + 16*d5os*(-CF + tu/nu**1.6666666666666667)**2))/(nu**1.6666666666666667*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**4) - (8*alphaos*(d1os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665) + 4*d2os*(-CF + tu/nu**1.6666666666666667)))/(nu**1.6666666666666667*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3) + ((4*d4os*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665))/nu**1.6666666666666667 + (32*d5os*(-CF + tu/nu**1.6666666666666667))/nu**1.6666666666666667)/(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**3 - (4*alphaos*d0os)/(nu**1.6666666666666667*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2) + (4*d2os)/(nu**1.6666666666666667*(1 + alphaos*(g2d/nd**2.6666666666666665 + g2u/nu**2.6666666666666665 + 4*(-CF + tu/nu**1.6666666666666667)))**2)) + (cu*(((d3ss*g2u**2)/nu**5.333333333333333 + (2*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2u)/nu**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/tu - (cu*(-g2u/8. + nu*tu)*(((d3ss*g2u**2)/nu**5.333333333333333 + (2*d4ss*g2u*(-CF + tu/nu**1.6666666666666667))/nu**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2u)/nu**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2u/nu**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/(nu*tu**2)
        dtd = (cd*(((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/td - (cd*(-g2d/8. + nd*td)*(((d3ss*g2d**2)/nd**5.333333333333333 + (2*d4ss*g2d*(-CF + tu/nu**1.6666666666666667))/nd**2.6666666666666665 + 4*d5ss*(-CF + tu/nu**1.6666666666666667)**2)/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**3 + ((d1ss*g2d)/nd**2.6666666666666665 + 2*d2ss*(-CF + tu/nu**1.6666666666666667))/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667)))**2 + d0ss*(-1 + 1/(1 + alphass*(g2d/nd**2.6666666666666665 + 2*(-CF + tu/nu**1.6666666666666667))))))/(nd*td**2)

        return en, dcu, dcd, dco, dnu, dnd, dg2u, dg2d, dtu, dtd

